<div class="p-6 bg-white dark:bg-gray-900 min-h-screen">
  <!-- Imagem do Evento -->
  <div class="mb-8">
    <div class="relative w-full h-64 bg-gray-200 dark:bg-gray-700 rounded-lg overflow-hidden">
      <img 
        [src]="imagePreview || event.image || cardSettings.backgroundImage || '/images/cards/event2.jpg'" 
        [alt]="event.name || 'Imagem do evento'"
        class="w-full h-full object-cover"
      >
      <div class="absolute top-4 left-4">
        <label for="image-upload" class="cursor-pointer bg-white dark:bg-gray-800 px-3 py-2 rounded-lg shadow-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
          <span class="text-sm font-medium text-gray-700 dark:text-gray-300">{{ 'events.view.image.changeLabel' | translate }}</span>
          <input 
            id="image-upload" 
            type="file" 
            accept="image/*" 
            class="hidden" 
            (change)="onImageUpload($event)"
          >
        </label>
      </div>
    </div>
  </div>

  <!-- Abas de Navegação -->
  <div class="mb-6">
    <div class="border-b border-gray-200 dark:border-gray-700">
      <nav class="-mb-px flex space-x-8">
        <button
          (click)="setActiveTab('detalhes')"
          [class]="activeTab === 'detalhes' 
            ? 'border-blue-500 text-blue-600 dark:text-blue-400 border-b-2 font-medium text-sm py-2 px-1' 
            : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600 border-b-2 font-medium text-sm py-2 px-1'"
        >
          {{ 'events.view.tabs.details' | translate }}
        </button>
        <button
          (click)="setActiveTab('cartao')"
          [class]="activeTab === 'cartao' 
            ? 'border-blue-500 text-blue-600 dark:text-blue-400 border-b-2 font-medium text-sm py-2 px-1' 
            : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600 border-b-2 font-medium text-sm py-2 px-1'"
        >
          {{ 'events.view.tabs.accessCard' | translate }}
        </button>
        
      </nav>
    </div>
  </div>

  <!-- Conteúdo das Abas -->
  <div class="mb-8">
    <!-- Aba Detalhes -->
    <div *ngIf="activeTab === 'detalhes'" class="space-y-6">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Coluna 1: Nome, Descrição e Datas -->
        <div class="space-y-4">
          <h3 class="text-lg font-semibold text-gray-900 dark:text-white">{{ 'events.view.details.title' | translate }}</h3>

          <div>
            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">{{ 'events.view.details.fields.eventName.label' | translate }}</label>
            <input type="text" id="eventName" name="eventName" [(ngModel)]="event.name" #nameModel="ngModel" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white" [placeholder]="'events.view.details.fields.eventName.placeholder' | translate" [class.border-red-500]="nameModel.invalid && nameModel.touched">
            <p *ngIf="nameModel.invalid && nameModel.touched" class="mt-1 text-sm text-red-600 dark:text-red-400">Campo obrigatório.</p>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">{{ 'events.view.details.fields.description.label' | translate }}</label>
            <textarea id="description" name="description" rows="4" [(ngModel)]="event.description" #descModel="ngModel" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white" [placeholder]="'events.view.details.fields.description.placeholder' | translate" [class.border-red-500]="descModel.invalid && descModel.touched"></textarea>
            <p *ngIf="descModel.invalid && descModel.touched" class="mt-1 text-sm text-red-600 dark:text-red-400">Campo obrigatório.</p>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">{{ 'events.view.details.datetimeSection.title' | translate }}</label>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2">{{ 'events.view.details.datetimeSection.startDate.label' | translate }}</label>
                <input type="datetime-local" id="startDate" name="startDate" [(ngModel)]="event.startDate" #startModel="ngModel" required (change)="onDateChange('start', $event)" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white" [class.border-red-500]="startModel.invalid && startModel.touched">
                <p *ngIf="startModel.invalid && startModel.touched" class="mt-1 text-sm text-red-600 dark:text-red-400">Campo obrigatório.</p>
              </div>
              <div>
                <label for="endDate" class="block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2">{{ 'events.view.details.datetimeSection.endDate.label' | translate }}</label>
                <input type="datetime-local" id="endDate" name="endDate" [(ngModel)]="event.endDate" #endModel="ngModel" required [min]="event.startDate" (change)="onDateChange('end', $event)" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white" [class.border-red-500]="endModel.invalid && endModel.touched">
                <p *ngIf="endModel.invalid && endModel.touched" class="mt-1 text-sm text-red-600 dark:text-red-400">Campo obrigatório.</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Coluna 2: Localização e Responsável -->
        <div class="space-y-4">
          <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Dados do Evento</h3>

          <div>
            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">{{ 'events.view.details.fields.location.label' | translate }}</label>
            <input type="text" [(ngModel)]="event.location" #locModel="ngModel" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-white" placeholder="Informe a localidade do evento" [class.border-red-500]="locModel.invalid && locModel.touched">
            <p *ngIf="locModel.invalid && locModel.touched" class="mt-1 text-sm text-red-600 dark:text-red-400">Campo obrigatório.</p>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Responsável</label>
              <input type="text" [(ngModel)]="event.responsibleName" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-white" placeholder="Nome do responsável">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email do responsável</label>
              <input type="email" [(ngModel)]="event.responsibleEmail" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-white" placeholder="email@exemplo.com">
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Telefone</label>
              <input type="tel" [(ngModel)]="event.responsiblePhone" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-white" placeholder="(00) 00000-0000">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Cidade</label>
              <input type="text" [(ngModel)]="event.city" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-white" placeholder="Cidade">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Estado</label>
              <input type="text" [(ngModel)]="event.state" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-white" placeholder="UF">
            </div>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Endereço</label>
            <input type="text" [(ngModel)]="event.address" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-white" placeholder="Rua, número, complemento">
          </div>
        </div>
      </div>
    </div>

    <!-- Aba Cartão Acesso -->
    <div *ngIf="activeTab === 'cartao'" class="space-y-6">
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          <!-- Configurações do Cartão -->
          <div class="space-y-6">
            <h4 class="text-lg font-semibold text-gray-900 dark:text-white">{{ 'events.view.card.title' | translate }}</h4>
            <app-card-settings 
              [settings]="cardSettings"
              (settingsChange)="onCardSettingsChange($event)">
            </app-card-settings>
          </div>
          <!-- Preview do Cartão -->
          <div class="space-y-4">
            <h4 class="text-lg font-semibold text-gray-900 dark:text-white">{{ 'events.view.card.preview.title' | translate }}</h4>
            <div class="flex justify-center">
              <div class="card-preview relative" 
                   [style.background]="getCardBackground()"
                   style="width: 180px; height: 280px; border-radius: 16px; position: relative; overflow: hidden; box-shadow: 0 8px 25px -5px rgba(0, 0, 0, 0.3); display: flex; flex-direction: column; align-items: center; padding: 16px; justify-content: space-between;">
                <!-- Simulação de clipe no topo -->
                <div class="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-24 h-12 bg-gray-300 rounded-t-full" style="border-bottom: 2px solid gray;"></div>
                <!-- Nome do Evento (no topo) -->
                <div class="text-center mt-6">
                  <h3 class="text-white text-sm font-bold drop-shadow-lg leading-tight">{{ event.name }}</h3>
                </div>
                <!-- Badge Circular VIP ACCESS -->
                <div class="flex flex-col items-center justify-center bg-black rounded-full w-24 h-24 text-white text-center my-4">
                  <span class="text-xl font-bold">{{ 'events.view.card.preview.badge.vip' | translate }}</span>
                  <span class="text-xs">{{ 'events.view.card.preview.badge.access' | translate }}</span>
                </div>
                <!-- QR Code (na parte inferior) -->
                <div class="flex justify-center mt-auto">
                  <div class="w-16 h-16 bg-white p-1">
                    <!-- Placeholder QR Code -->
                    <svg width="100%" height="100%" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <rect width="100" height="100" fill="white"/>
                      <rect x="10" y="10" width="20" height="20" fill="black"/>
                      <rect x="10" y="35" width="20" height="20" fill="black"/>
                      <rect x="10" y="60" width="20" height="20" fill="black"/>
                      <rect x="35" y="10" width="20" height="20" fill="black"/>
                      <rect x="60" y="10" width="20" height="20" fill="black"/>
                      <rect x="35" y="35" width="20" height="20" fill="black"/>
                      <rect x="60" y="35" width="20" height="20" fill="black"/>
                      <rect x="35" y="60" width="20" height="20" fill="black"/>
                      <rect x="60" y="60" width="20" height="20" fill="black"/>
                      <rect x="10" y="85" width="20" height="5" fill="black"/>
                      <rect x="35" y="85" width="20" height="5" fill="black"/>
                      <rect x="60" y="85" width="20" height="5" fill="black"/>
                      <rect x="85" y="10" width="5" height="20" fill="black"/>
                      <rect x="85" y="35" width="5" height="20" fill="black"/>
                      <rect x="85" y="60" width="5" height="20" fill="black"/>
                      <!-- Linhas diagonais para efeito -->
                      <line x1="20" y1="20" x2="80" y2="80" stroke="black" stroke-width="2"/>
                      <line x1="80" y1="20" x2="20" y2="80" stroke="black" stroke-width="2"/>
                    </svg>
                  </div>
                </div>
              </div>
            </div>
            <!-- Informações do Cartão -->
            <div class="text-center text-sm text-gray-600 dark:text-gray-400">
              <p>Dimensões: 180px × 280px (Formato Vertical)</p>
              <p class="mt-1">As configurações serão aplicadas a todos os cartões de convidados</p>
            </div>
          </div>
        </div>
      </div>
      <!-- Botão Salvar (Cartão) -->
      <div class="mt-6">
        <button
          (click)="saveCardSettings()"
          [disabled]="isSaving || !isDetailsValid()"
          class="w-full bg-blue-600 hover:bg-blue-700 disabled:opacity-60 disabled:cursor-not-allowed text-white font-medium py-3 px-6 rounded-lg transition-colors shadow-md hover:shadow-lg flex items-center justify-center"
        >
          <span *ngIf="!isSaving">{{ 'events.view.actions.saveCard' | translate }}</span>
          <span *ngIf="isSaving" class="flex items-center gap-2">
            <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
            </svg>
            Salvando...
          </span>
        </button>
      </div>
    </div>

    
  </div>

  <!-- Botão Salvar (Detalhes) - Acima da Lista de Convidados -->
  <div class="mt-8 mb-6" *ngIf="activeTab === 'detalhes'">
    <button
      (click)="saveEvent()"
      [disabled]="isSaving || !isDetailsValid()"
      class="w-full bg-green-600 hover:bg-green-700 disabled:opacity-60 disabled:cursor-not-allowed text-white font-medium py-3 px-6 rounded-lg transition-colors shadow-md hover:shadow-lg flex items-center justify-center"
    >
      <span *ngIf="!isSaving">{{ 'events.view.actions.save' | translate }}</span>
      <span *ngIf="isSaving" class="flex items-center gap-2">
        <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
        </svg>
        Salvando...
      </span>
    </button>
    <div *ngIf="saveMessage" class="mt-3 text-green-600 dark:text-green-400 text-sm">{{ saveMessage }}</div>
    <div *ngIf="saveError" class="mt-3 text-red-600 dark:text-red-400 text-sm">{{ saveError }}</div>
  </div>

  
  <!-- Removida a lista de convidados nesta etapa de criação -->