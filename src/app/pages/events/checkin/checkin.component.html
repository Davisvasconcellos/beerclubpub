<div class="min-h-screen w-full bg-gray-900 text-white">
  <div class="mx-auto max-w-2xl px-6 py-8">
    <!-- Banner com selfie sobreposta -->
    <div class="mb-4">
      <div class="relative rounded-2xl overflow-hidden border border-white/10 bg-white/5">
        <img *ngIf="eventBannerUrl" [src]="eventBannerUrl" [alt]="eventName || 'Evento'" class="w-full h-40 object-cover" />
        <div class="absolute inset-0 flex items-center justify-center">
          <button (click)="triggerCamera()" class="group relative w-28 h-28 sm:w-32 sm:h-32 rounded-full overflow-hidden ring-2 ring-white/60 bg-black/20 backdrop-blur border border-white/30 flex items-center justify-center hover:bg-black/30 transition-colors">
            <ng-container *ngIf="!selfieUrl; else selfieCircle">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-14 h-14 sm:w-16 sm:h-16 text-white/80 group-hover:text-white" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M4 7h3l2-2h6l2 2h3a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V9a2 2 0 012-2z" />
                <circle cx="12" cy="13" r="3.5" />
              </svg>
            </ng-container>
            <ng-template #selfieCircle>
              <img [src]="selfieUrl" alt="Selfie" class="w-full h-full object-cover" />
            </ng-template>
            <!-- Loader enquanto envia -->
            <div *ngIf="uploadingSelfie" class="absolute inset-0 flex items-center justify-center bg-black/20">
              <div class="w-6 h-6 rounded-full border-2 border-white/30 border-t-white animate-spin"></div>
            </div>
          </button>
        </div>
      </div>
      <div class="mt-3 px-2">
        <h2 class="text-xl font-semibold">{{ eventName || 'Evento' }}</h2>
        <div class="text-center">
          <span class="mt-2 inline-block text-xs bg-white/10 px-2 py-0.5 rounded-md border border-white/10">Tirar Selfie</span>
        </div>
      </div>
    </div>

    <!-- Título e descrição -->
    <div class="text-center">
      <h1 class="mt-4 text-2xl font-semibold">Check-in do Evento</h1>
      <p class="mt-2 text-sm text-white/70">Confirme seus dados e prossiga ao questionário.</p>
    </div>

    <!-- Form de dados do usuário -->
    <div class="mt-8 rounded-2xl bg-white/[0.03] border border-white/10 p-6 backdrop-blur">
      <div>
        <app-input-field placeholder="Seu nome completo" [value]="displayName" (valueChange)="onNameChange($event)" [hint]="nameError ? 'Campo obrigatório' : 'Como vc prefere ser chamado'" [error]="nameError"></app-input-field>
      </div>
      <div class="mt-4">
        <app-input-field placeholder="seu@email.com" [value]="email" (valueChange)="onEmailChange($event)" [readonly]="true"></app-input-field>
      </div>
      <div class="mt-4">
        <app-input-field label="Telefone" placeholder="(00) 00000-0000" [value]="phone" (valueChange)="onPhoneChange($event)"></app-input-field>
      </div>

      <div class="mt-6">
        <app-button variant="primary" className="w-full sm:w-auto" (btnClick)="onSubmit()" [disabled]="submitting || !displayName.trim()">
          {{ submitting ? 'Enviando...' : 'Confirmar Check-in' }}
        </app-button>
      </div>

      <div class="mt-4" *ngIf="submitError">
        <div class="text-red-400 text-sm">{{ submitError }}</div>
      </div>

      <div class="mt-4" *ngIf="submitSuccess">
        <div class="text-green-400 text-sm">Check-in realizado com sucesso!</div>
      </div>
    </div>
  </div>

  <!-- Overlay da Câmera -->
  <div *ngIf="cameraOpen" class="fixed inset-0 z-50 bg-black/80 flex items-center justify-center">
    <div class="w-full max-w-md p-4">
      <div class="relative rounded-xl overflow-hidden border border-white/20 bg-black">
        <video #video autoplay playsinline class="w-full"></video>
        <canvas #canvas class="hidden"></canvas>
        <!-- Loader enquanto a câmera inicia -->
        <div *ngIf="cameraLoading" class="absolute inset-0 flex items-center justify-center bg-black/40">
          <div class="w-8 h-8 rounded-full border-2 border-white/30 border-t-white animate-spin"></div>
        </div>
      </div>
      <div class="mt-4 grid grid-cols-2 gap-3">
        <app-button variant="outline" className="w-full" (btnClick)="stopCamera()">Cancelar</app-button>
        <app-button className="w-full" (btnClick)="captureSelfie()">Capturar</app-button>
      </div>
    </div>
  </div>
</div>